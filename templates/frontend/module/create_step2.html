{% extends "base/base-content.html" %}

{% load i18n %}

{% block titleSite %}{% trans 'Create module' %}{% endblock %}

{% block js %}
    <script type="text/javascript" src="{{ STATIC_URL }}js/typeahead.min.js"></script>
    <script type="text/javascript" src="{{ STATIC_URL }}js/hogan.js"></script>
    <script>
    function delete_row_author(e){
        $(e).parent().parent().remove();
    };
    $(document).ready(function(){
        $('.search-author').typeahead({
            name: 'authors',
            valueKey: 'fullname',
            remote: "{% url 'ajax_search_author' %}?keyword=%QUERY",
            template: [
                '<p class="item-fullname">{% verbatim %}{{fullname}}{% endverbatim %}</p>',
                '<p class="item-email">{% verbatim %}{{email}}{% endverbatim %}</p>',
            ].join(''),
            engine: Hogan,
            limit: 10
        });

        $('.search-author').on('typeahead:selected', function (object, datum) {
            var template = Hogan.compile(ITEM_TEMPLATE);
            var output = template.render(datum);
            $('#listAuthor tbody').append(output);
            $('.search-author').val('');
        });


        var ITEM_TEMPLATE = ['<tr>',
            '<td class="author-block">',
            '<a class="hfbtn-author" href="#">{% verbatim %}{{fullname}}{% endverbatim %}',
            '<div class="author-information">',
            '<div class="avatar left">',
            '<img src="images/avatar.jpg" width="70px" height="70px">',
            '</div>',
            '<div class="right">',
            '<div class="user-name">{% verbatim %}{{fullname}}{% endverbatim %}</div>',
            '<div class="user-address">{% verbatim %}{{email}}{% endverbatim %}</div>',
            '<div class="user-website">{% verbatim %}{{homepage}}{% endverbatim %}</div>',
            '</div>',
            '</div>',
            '</a>',
            '</td>',
            '<td>',
            '<input type="checkbox" value="{% verbatim %}{{id}}{% endverbatim %}" name="authors">',
            '</td>',
            '<td>',
            '<input type="checkbox" value="{% verbatim %}{{id}}{% endverbatim %}" name="editors">',
            '</td>',
            '<td>',
            '<input type="checkbox" name="{% verbatim %}{{id}}{% endverbatim %}" name="licensors">',
            '</td>',
            '<td>',
            '<input type="checkbox" name="{% verbatim %}{{id}}{% endverbatim %}" name="maintainers">',
            '</td>',
            '<td>',
            '<input type="checkbox" name="{% verbatim %}{{id}}{% endverbatim %}" name="translators">',
            '</td>',
            '<td>',
            '<input type="checkbox" name="{% verbatim %}{{id}}{% endverbatim %}" name="coeditors">',
            '</td>',
            '<td><div class="hfbtn-delete" onclick="delete_row_author(this)"></div></td>',
            '</tr>'].join('\n');

    });
    </script>
{% endblock %}

{% block content %}        

            <!-- filter top -->
            <div class="hfcreate">
    <div class="breakcump left">
        <span>{% trans 'Create Content' %}</span>
        <span class="icon"></span>
        <span class="current">{% trans 'Create a new module' %}</span>
    </div>
    <div class="hfstep">
        <ul>
            <li class="active"><a id="hfstep-1"><div class="step">1</div> {% trans 'License' %}</a></li>
            <li class="active"><a id="hfstep-2"><div class="step">2</div>{% trans 'Metadata' %}</a></li>
            <li><a id="hfstep-3"><div class="step">3</div>{% trans 'Content' %}</a></li>
        </ul>
    </div>
</div>
{% include "frontend/block/left_block_user.html" %}
            <div class="col-lg-1 right-row">
                <div class="hfcreate-1">
                    {% if form.errors %}
                        <div class="alert alert-danger">
                            <ul>
                        {% for field in form %}
                            {% for error in field.errors %}
                                <li>{{ field.label }} - {{ error|escape }}</li>
                            {% endfor %}
                        {% endfor %}
                            </ul>
                        </div>
                    {% endif %}
                    <!-- Nav tabs -->
                    <ul class="nav nav-tabs">
                      <li class="active"><a href="#metadata" data-toggle="tab">{% trans 'Metadata' %}</a></li>
                    </ul>
                    
                    <!-- Tab panes -->
                    <div class="tab-content">                   
                      <div class="tab-pane active" id="metadata">
                        <div class="content">
    <form role="form" method="post">
        {% csrf_token %}
		<div class="form-group">
			<label for="InputEmail1">{% trans 'Title' %}</label>
			<input type="text" class="form-control typetext" id="InputText" placeholder="{% trans 'Enter title' %}" name="title" value="{{ form.title.value }}">
		</div>
		<div class="form-group">
			<label for="InputDescription">{% trans 'Description' %}</label>
			<textarea rows="4" class="form-control" name="description">{{ form.description.value }}</textarea>
		</div>
		<div class="form-group">
			<label for="InputAuthor">{% trans 'Add more author' %}</label>
			<input type="text" class="form-control search-author"  autocomplete="off"
                   id="InputAuthor" placeholder="{% trans 'Enter an author' %}">
			<!-- <a class="AddNew" href="#addnewauthor">{% trans 'Add new Author' %}</a> -->
		</div>
		<div class="form-group listAuthor">
			<table class="listAuthor" id="listAuthor">
				<thead>
					<tr>
                        <th>{% trans 'Name' %}</th>
                        <th>{% trans 'Author' %}</th>
                        <th>{% trans 'Editor' %}</th>
                        <th>{% trans 'Licensor' %}</th>
                        <th>{% trans 'Maintainer' %}</th>
                        <th>{% trans 'Translator' %}</th>
                        <th>{% trans 'Contributor' %}</th>
						<th></th>
					</tr>
				</thead>
				<tbody>
					<tr>
						<td class="author-block">
							<a class="hfbtn-author" href="#">{{ author.fullname }}
								<div class="author-information">
									<div class="avatar left">
										<img src="images/avatar.jpg" width="70px" height="70px">
									</div>
									<div class="right">
										<div class="user-name">{{ author.fullname }}</div>
										<div class="user-address">{{ author.email }}</div>
										<div class="user-website">{{ author.homepage }}</div>
									</div>
								</div>
							</a>
						</td>
						<td>
                            <input type="checkbox"  value="{{ author.id }}" name="authors" checked>
						</td>
						<td>
                            <input type="checkbox" value="{{ author.id }}" name="editors" checked>
						</td>
						<td>
                            <input type="checkbox" name="{{ author.id }}" name="licensors">
						</td>
						<td>
                            <input type="checkbox" name="{{ author.id }}" name="maintainers">
						</td>
						<td>
                            <input type="checkbox" name="{{ author.id }}" name="translators">
						</td>
						<td>
                            <input type="checkbox" name="{{ author.id }}" name="coeditors">
						</td>
						<td style="width:25px;">&nbsp;</td>
					</tr>
				</tbody>
			</table>
		</div>
		<div class="form-group">
			<label for="InputCategories">{% trans 'Categories' %}</label>
			<ul class="AddCategories">
                {% for category in categories %}
				<li>
					<label class="checkbox checkbox-user-tool">
						<span class="icons">
							<span class="first-icon fui-checkbox-unchecked"></span>
							<span class="second-icon fui-checkbox-checked"></span>
						</span>
						<input type="checkbox" data-toggle="checkbox" name="categories" value="{{ category.id }}" {% if category.id == form.categories.value|add:0 %}checked{% endif %}>
						{{ category.name }}
					</label>
				</li>
                {% endfor %}
			</ul>
		</div>
		<div class="form-group">
			<label for="InputFile">{% trans 'Image' %}</label>
			<input type="file" onmouseout="document.getElementById('uploadfilename_0').value = this.value;" onchange="document.getElementById('uploadfilename_0').value = this.value;" class="uploadfile" id="uploadfile_0" name="uploadfile_0">
		    <div class="fakefile">
		    	<input type="text" onclick="document.getElementById('uploadfile_0').click();" id="uploadfilename_0" value="" class="form-control typefile">
		    </div>
		    <p class="help-block">Files must be less than 2 MB. <br>Allowed file types: png gif jpg jpeg.</p>
		</div>
		<div class="form-group">
			<label for="InputLanguage">{% trans 'Language' %}</label>
			<div class="hfselectList">
				<select class="select-block" name="language">
					<option value="00">{% trans 'Choose language' %}</option>
					<option value="vi" {% if material.language == "vi" %}selected="selected"{% endif %}>{% trans 'Vietnamese' %}</option>
					<option value="en" {% if material.language == "en" %}selected="selected"{% endif %}>{% trans 'English' %}</option>
				</select>
			</div>
		</div>
		<div class="form-group">
			<label for="InputKeywords">{% trans 'Keywords' %}</label>
			<input type="text" class="form-control typetext" id="InputKeywords"
                   placeholder="{% trans 'Enter keywords' %}" name="keywords" value="{{ form.keywords.value }}">
		</div>
		<div class="form-group">
			<label for="InputTags">{% trans 'Tags' %}</label>
			<input type="text" class="form-control typetext" id="InputTags"
                   placeholder="{% trans 'Enter tags' %}" name="tags" value="{{ form.tags.value }}">
		</div>
		<div class="form-group btn-common">
            <input type="hidden" name="step" value="2" />
			<button class="btn hfbtn-common hfbtn-next right hfbtn-active" value="next" name="action">{% trans 'Next' %}</button>
			<button class="btn hfbtn-common hfbtn-back right hfbtn-active" value="back" name="action">{% trans 'Back' %}</button>
		</div>
    </form>
</div>                    </div>
                    </div>

                </div>
            </div>
{% endblock %}